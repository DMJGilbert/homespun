<!DOCTYPE HTML>
<html>

<head>
	<!-- Change URLs to wherever Video.js files will be hosted -->
	<link href="/tv/video-js.css" rel="stylesheet" type="text/css">
	<!-- video.js must be in the <head> for older IEs to work. -->
	<script type="text/javascript" src="/socket.io/socket.io.js"></script>

	<style>
		html,
		body,
		#video_container {
			margin: 0;
			padding: 0;
			height: 100%;
			width: 100%;
			overflow: hidden;
		}

		.vjs-default-skin .vjs-big-play-button {
			display: none;
		}

		#notifications_container {
			position: absolute;
			top: 20px;
			right: 0;
		}

		.notification {
			width: 200px;
			height: 50px;
			font-size: 20px;
			font-family: 'arial';
			background-color: #4183D7;
			color: #fff;
			padding: 20px;
			overflow: hidden;
			border-left: 5px solid #fff;
			margin-bottom: 20px;
		}
	</style>

</head>

<body>

	<div id="video_container">
		<video id="video" class="video-js vjs-default-skin" controls="false" preload="none" width="100%" height="100%" data-setup="{&quot;techOrder&quot;: [&quot;flash&quot;]}" autoplay>
			<source id="videoSrc" src="<%= url %>" type="video/mp4">
		</video>
	</div>

	<div id="notifications_container">

	</div>

	<script>
		var notcounter = 0;

		var ioParams = {
			'reconnection limit': 3000,
			'max reconnection attempts': Number.MAX_VALUE,
			'connect timeout': 7000
		};
		var socket = io.connect("", ioParams);

		socket.on('connect', function () {
			console.log("Connected");
			socket.emit('tv');
		});
		socket.on('reload', function (data) {
			location.reload();
		});
		socket.on('play', function (data) {
			window.location.href = "/tv/?url=" + data.url;
		});
		socket.on('notification', function (data) {
			var index = notcounter++;
			var notifications_container = document.getElementById('notifications_container');
			notifications_container.innerHTML = '<div class="notification" id="not-' + index + '">' + data.message + '</div>' + notifications_container.innerHTML;

			setTimeout(function () {
				var notification = document.getElementById("not-" + index);
				notification.parentElement.removeChild(notification);
			}, 10000)
		});
		socket.on('disconnect', function () {

		});
	</script>


	<script id="videojavascript" id="videoscript" src="/tv/video.js"></script>
	<script>
		videojs.options.flash.swf = "/tv/video-js.swf";
	</script>
</body>

</html>
